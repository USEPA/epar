<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GitHub, OneDrive, and Records! Oh My! • epar</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="GitHub, OneDrive, and Records! Oh My!">
<meta property="og:description" content="epar">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/github_ondrive_records.html">GitHub, OneDrive, and Records! Oh My!</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/usepa/epar/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>GitHub, OneDrive, and Records! Oh My!</h1>
                        <h4 data-toc-skip class="author">Jeffrey W.
Hollister</h4>
            
            <h4 data-toc-skip class="date">2024-05-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/usepa/epar/blob/HEAD/vignettes/github_ondrive_records.Rmd" class="external-link"><code>vignettes/github_ondrive_records.Rmd</code></a></small>
      <div class="hidden name"><code>github_ondrive_records.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="tldr">TL;DR<a class="anchor" aria-label="anchor" href="#tldr"></a>
</h2>
<p>If you have a GitHub and local git repository that is not on OneDrive
(e.g. git repos and OneDrive are best to not be mixed!), we can set up a
mirror on OneDrive that will satisfy records requirements because EPA
does not consider GitHub repos as records. Our files on OneDrive are
records and are backed up.</p>
<p>If you are working in R in the git repository (aside: An RStudio
project would be an excellent way to manage this) you can do the
following to set up a mirror repo on OneDrive.</p>
<p>First, make sure you have the <code>epar</code> pacakge installed
from GitHub.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"usepa/epar"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/usepa/epar" class="external-link">epar</a></span><span class="op">)</span></span></code></pre></div>
<p>With that taken care of we can use the <code><a href="../reference/add_mirror_repo.html">add_mirror_repo()</a></code>
and <code><a href="../reference/one_drive_mirror.html">one_drive_mirror()</a></code> functions to get everything set
up.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mirror</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/one_drive_mirror.html">one_drive_mirror</a></span><span class="op">(</span><span class="st">"projects"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_mirror_repo.html">add_mirror_repo</a></span><span class="op">(</span><span class="va">mirror</span><span class="op">)</span></span></code></pre></div>
<p>For details read the rest!</p>
</div>
<div class="section level2">
<h2 id="records-onedrive-and-github">Records, OneDrive, and Github<a class="anchor" aria-label="anchor" href="#records-onedrive-and-github"></a>
</h2>
<p>Currently, files stored on EPA’s Enterprise GitHub do not meet the
requirements for records, therefore we need to find alternative means to
make sure our GitHub based work is captured in a records friendly way.
The most widely used solution for saving digital files so that they
comply with EPA records requirements is to use EPA’s OneDrive. For most
files this is the default for EPA systems and a perfectly fine solution.
However, using OneDrive to store local git repositories is a problematic
proposition.</p>
<div class="section level3">
<h3 id="git-and-onedrive">Git and OneDrive<a class="anchor" aria-label="anchor" href="#git-and-onedrive"></a>
</h3>
<p>The are several potential problems with storing active local git
repositories on OneDrive and they arise from OneDrive syncs and possible
conflicts between git and OneDrive’s version histories.</p>
<p>First, since OneDrive is monitoring changes to folders and attempting
to sync those changes to the cloud, any change to a large number of
files has the potential to significantly tax you local computing
resources. If you use branches in your local git repository, anytime you
switch branches that has the potential to change many file and folders
in the repo and thus, OneDrive will try to sync everything to the cloud
everytime you change branches.</p>
<p>Second, OneDrive’s built in version history is not git aware and thus
if any changes occur to the same files on OneDrive it will rename those
files. This is fundamentally different than how git manages versions and
these two approaches have the potential to conflict with one another.
This raises the possibility of corrupting your git version history.</p>
<p>If you are working on a git repo on OneDrive with only yourself, the
chance of this occurring is low; however, if you are working on a shared
OneDrive location that is also a git repository, there is a much higher
chance of corruption and if you have multiple users on a git repo on
OneDrive and use a branching workflow, corruption of that repository is
essentially assured.</p>
</div>
</div>
<div class="section level2">
<h2 id="one-solution">One Solution<a class="anchor" aria-label="anchor" href="#one-solution"></a>
</h2>
<p>One solution that will allow users to use git and GitHub while also
maintaining records is to maintain your GitHub repository as a shared
remote repository, work on a local git repository on a local drive (C:
or external drive), and mirror this local repository to their OneDrive
on each push. This workflow is capture in Figure 1.</p>
<p><img src="mirrored_workflow.png" alt="Figure 1. Mirrored GitHub Repository"> In order to use this
workflow some alterations are needed for local repositories.</p>
<ul>
<li>Clone local repository, as a “bare” repository, to a OneDrive
location.</li>
<li>Set up multiple “push” remotes in the local repository that first
push to the GitHub remote, and then to the cloned “bare” repository on
One Drive.</li>
<li>Do not work directly on the “bare” repository on OneDrive. This is
simply a mirror that is at the same spot in the version control history
as the last local push to GitHub.</li>
<li>Do work, commit, and push changes per your normal git workflow on
you local repository. Each push will send all committed changes first to
GitHub, then to OneDrive. No additional steps are required.</li>
<li>If you need to recover files from the OneDrive mirror, it will need
to be cloned with git to restore the files.</li>
</ul>
<p>To set this all up in R, you may use the
<code><a href="../reference/add_mirror_repo.html">add_mirror_repo()</a></code> and <code><a href="../reference/one_drive_mirror.html">one_drive_mirror()</a></code>
functions in the <code>epar</code> package. This function assumes and
test that the repo you would like to mirror is an existing git
repository.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"usepa/epar"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/usepa/epar" class="external-link">epar</a></span><span class="op">)</span></span></code></pre></div>
<p>With the latest version of the <code>epar</code> package installed
from GitHub you can create the path for your mirror and then create it.
In the code below, I am setting up a mirror in a “projects” folder on my
OneDrive the name of the mirror repo defaults to the name of the local
repository.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_mirror</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/one_drive_mirror.html">one_drive_mirror</a></span><span class="op">(</span><span class="st">"projects"</span><span class="op">)</span></span>
<span><span class="va">my_mirror</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "/home/runner./projects/epar"</span></span></code></pre>
<p>Then you can set it up with:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/add_mirror_repo.html">add_mirror_repo</a></span><span class="op">(</span><span class="va">my_mirror</span><span class="op">)</span></span></code></pre></div>
<p>And then to just make sure my remotes look correct run this from the
terminal:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">git</span> remote <span class="at">-v</span></span></code></pre></div>
<pre><code><span><span class="co">## origin   https://github.com/USEPA/epar (fetch)</span></span>
<span><span class="co">## origin   https://github.com/USEPA/epar (push)</span></span>
<span><span class="co">## origin   C:\Users\JHollist\OneDrive - Environmental Protection Agency (EPA)\projects\epar (push)</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jeffrey Hollister.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
